<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Hello Jersey</title>
<link href="Sencha/sencha-touch.css" rel="stylesheet" type="text/css" />
<link href="Sencha/styles.css" rel="stylesheet" type="text/css" />
<script src="Sencha/sencha-touch-all.js" type="text/javascript"></script>
<script src="Sencha/ext-all.js" type="text/javascript"></script>
<script type="text/javascript">

Ext.onReady(function() {
	Ext.define('Bond', {
        extend: 'Ext.data.Model',
        fields: ['trialId', 'briefTitle', 'officialTitle', 'sponsors','authority', 'studyType','studyDesign','summary','status','stDate','endDate','phase','criteria','gender','minAge','maxAge','officialLastName','officialRole','officialAffiliation','retDate','tags']
    });

    var store = new Ext.data.Store({
        model: 'Bond',
        proxy: {
            type: 'ajax',
            url: 'http://localhost:8080/ClinicalTrials/rest/params/advSearchRes',
            reader: {
                type: 'json',
                root: 'ClinicalTrials'
            }
        }
    });
    store.load();
	
	var grid = Ext.create('Ext.grid.Panel', {
		
        title: 'Search Results',
        store : store,
        columns: [
                  {header: "Trial Id", width: 60, dataIndex: 'trialId', sortable: true},
                  {header: "Brief Title", width: 60, dataIndex: 'briefTitle', sortable: true},
                  {header: "Official Title", width: 60, dataIndex: 'officialTitle', sortable: true},
                  {header: "Sponsors", width: 100, dataIndex: 'sponsors', sortable: true},
                  {header: "Authority", width: 100, dataIndex: 'authority', sortable: true},
                  {header: "Study Type", width:80, dataIndex: 'studyType', sortable: true},             
                  {header: "Study Design", width:80, dataIndex: 'studyDesign', sortable: true},
                  {header: "Summary", width:80, dataIndex: 'summary', sortable: true},
                  {header: "Status", width:80, dataIndex: 'status', sortable: true},
                  {header: "Start Date", width:80, dataIndex: 'stDate', sortable: true},
                  {header: "End Date", width:80, dataIndex: 'endDate', sortable: true},
                  {header: "Phase", width:80, dataIndex: 'phase', sortable: true},
                  {header: "Criteria", width:80, dataIndex: 'criteria', sortable: true},
                  {header: "Gender", width:80, dataIndex: 'gender', sortable: true},
                  {header: "Min Age", width:80, dataIndex: 'minAge', sortable: true},
                  {header: "Max Age", width:80, dataIndex: 'maxAge', sortable: true},
                  {header: "Official Last Name", width:80, dataIndex: 'officialLastName', sortable: true},
                  {header: "Official Role", width:80, dataIndex: 'officialRole', sortable: true},
                  {header: "Official Affiliation", width:80, dataIndex: 'officialAffiliation', sortable: true},
                  {header: "Retrieval Date", width:80, dataIndex: 'retDate', sortable: true},
                  {header: "Tags", width:80, dataIndex: 'tags', sortable: true}
              ],
       viewConfig: {
           forceFit: true
       },        
       split: true,
       region: 'north',
       height: 300,
        width: 1000,
        renderTo: Ext.getBody()
    });
	
	// define a template to use for the detail view
    var bookTplMarkup = [
		'<b>Trial ID:</b><br/><br/> {trialId}<br/><br/>',
		'<b>Brief Title:</b><br/><br/> {briefTitle}<br/><br/>',
		'<b>Official Title:</b><br/><br/> {officialTitle}<br/><br/>',
		'<b>Sponsors:</b><br/><br/> {sponsors}<br/><br/>',
		'<b>Authority:</b><br/><br/> {authority}<br/><br/>',
		'<b>Study Type:</b><br/><br/> {studyType}<br/><br/>',
		'<b>Study Design:</b><br/><br/> {studyDesign}<br/><br/>',
		'<b>Status:</b><br/><br/> {status}<br/><br/>',
		'<b>Start Date:</b><br/><br/> {stDate}<br/><br/>',
		'<b>End Date:</b><br/><br/> {endDate}<br/><br/>',
        '<b>Summary:</b><br/><br/> {summary}<br/><br/>',
        '<b>Gender:</b><br/><br/> {gender}<br/><br/>',
        '<b>Gender:</b><br/><br/> {gender}<br/><br/>',
    ];
    var bookTpl = Ext.create('Ext.Template', bookTplMarkup);
    
	var panel = new Ext.create('Ext.Panel', {
        renderTo: 'binding-example',
        frame: true,
        autoscroll: true,
        scroll: 'vertical',
        centered: true,
        modal: true,
        draggable: true,
        title: 'Clinical Trials List',
        width: 1000,
        height: 2000,
        layout: 'border',        
        items: [
            grid,{
                id: 'detailPanel',
                region: 'center',
                bodyPadding: 7,
                bodyStyle: "background: #eaeaea;",
                html: 'Please select the clinical trial for more details.'
        }]
    });
	// update panel body on selection change
    grid.getSelectionModel().on('selectionchange', function(sm, selectedRecord) {
        if (selectedRecord.length) {
            var detailPanel = Ext.getCmp('detailPanel');
            bookTpl.overwrite(detailPanel.body, selectedRecord[0].data);
        }
    });
	 
	});
</script>
</head>
<body>
<div id="binding-example"></div>
</body>
</html>